<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>VIDEO</h1>
<button onclick="Capture()" style="font-size: 50px">Capture</button>
<button onclick="Play()" style="font-size: 50px">Play</button>
<button onclick="Detect()" style="font-size: 50px">Detect</button>
<video id="sth" playsinline webkit-playsinline></video>
<script>
    var video = document.getElementById('sth');
    window.Capture = function () {
        navigator.mediaDevices.getUserMedia({video: true}, onSuccess, onError).then(onSuccess).catch(onError);

        function onSuccess(stream) {
            console.log('success', stream);
            video.srcObject = stream;
            // video.play();

            setTimeout(function () {
                console.log('play!!!');
                video.play();
            }, 3000);
        }

        function onError(error) {
            console.error(error);
        }
    };
    window.Play = function () {
        video.play();
    };
    window.Detect = function () {
        const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        const isAndroid = navigator.userAgent.toLowerCase().indexOf('android') > -1;
        alert(navigator.userAgent + ' => isChrome: ' + isChrome + ', isAndroid: ' + isAndroid);
        if (isAndroid && isChrome) {
            const chromeVersionMatch = navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);

            alert(' chromeVersionMatch: ' + chromeVersionMatch);
            if (chromeVersionMatch) {
                alert(' parseInt(chromeVersionMatch[2], 10): ' + parseInt(chromeVersionMatch[2], 10));
                return parseInt(chromeVersionMatch[2], 10) <= 65;
            }
        }
        return false;
    }
</script>

<hr/>
<h1>Widget</h1>

<iframe src="https://8eo.github.io/sandbox/iframe.html"
        allow="geolocation; microphone; camera"
        style="border: 1px solid red; width: 100px; height: 100px;"></iframe>

<button onclick="Run">Run</button>
<!-- Horn Widget -->
<script type='text/javascript' src='https://dev.horn.co/widget/manager.js'></script>

<script>
    window.Run = function() {
        (function(){co.horn.widget.run({
            channel: '3271e8d8-6d81-478e-b6c1-3191d2fb3a1a',
            audio: {
                container: 'popup'
            }
        })})()
    }
</script>
</body>
</html>